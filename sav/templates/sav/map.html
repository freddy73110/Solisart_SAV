<!DOCTYPE html>
{% extends "sav/base.html" %}
{% load crispy_forms_tags %}
{% load static %}
{% load my_filter %}
{%block Titre%}{{title}}{%endblock%}

{% block javascript %}
<!--lien pour leaflet -->
<link rel="stylesheet" href="{% static 'leaflet/leaflet.css' %}" />
<script src="{% static 'leaflet/leaflet.js' %}"></script>
<!--lien pour leaflet regroup marker-->
<link rel="stylesheet" href="{% static 'Leaflet.markercluster-1.4.1/dist/MarkerCluster.css' %}" />
<link rel="stylesheet" href="{% static 'Leaflet.markercluster-1.4.1/dist/MarkerCluster.Default.css' %}" />
<script src="{% static 'Leaflet.markercluster-1.4.1/dist/leaflet.markercluster.js' %}"></script>
<script src="{% static 'js/sav/map.js' %}?{{10|randomfile}}" defer></script>
<!--lien pour tirf (compter le nombre d'installation par département)-->
<!--Todo download and install in static-->
<script src="https://cdn.jsdelivr.net/npm/@turf/turf@6/turf.min.js"></script>
<style>
  #nuancier {
    display: flex;
    align-items: flex-end;
    font-family: sans-serif;
    margin-top: 10px;
  }
  .nuance {
    width: 30px;
    height: 30px;
  }
  .label {
    font-size: 10px;
    text-align: center;
    margin-top: 2px;
  }
  #unite {
    text-align: center;
    margin-top: 4px;
    font-size: 12px;
    font-weight: bold;
  }

 #map{
    min-height: 600px; /* garde ton minimum */
    height: 600px;
    width: 100%; 
    position: relative;
    border: 2px solid #444;
  }

  #resizer {
    width: 15px;
    height: 15px;
    background: #444;
    position: absolute;
    right: 0;
    bottom: 0;
    cursor: se-resize;
    z-index: 1000;
  }
</style>
{%endblock%}

{%block article%}
<div class="container">
    <div class="row">
        <div class="col text-center m-3">
            <h1 class=" m-3">{{title}}</h1>
        </div>
    </div>
</div>


<div class="container">
    <div class="row">
        <div class="col-12">
            <form>{% csrf_token %}
                <div class="input-group mb-3">
                  <span class="input-group-text" id="basic-addon1"><i class="fas fa-search-location"></i></span>
                  <input type="text" name="adresse" class="form-control" id='adresse' placeholder="adresse" aria-label="Username" aria-describedby="basic-addon1">
                  <button class="btn btn-outline-secondary" type="button" id="button-addon2" onclick="search()">Rechercher</button>
                </div>
            </form>
            <fieldset class="border p-2 m-3" style = "border-width:3px">
                <legend class="float-none w-auto"><b>Afficher</b></legend>
                <div class="row">
                    <div class="col-1"></div>
                    <div class="form-check form-switch col-3">
                        <input class="form-check-input" type="checkbox" id="inputInstallateur">
                        <label class="form-check-label" for="nputInstallateur">Installateurs</label>
                    </div>
                    <div class="form-check form-switch col-3">
                        <input class="form-check-input" type="checkbox" id="inputInstallation">
                        <label class="form-check-label" for="inputInstallation">Installations</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-1"></div>
                    <div class="form-check form-check-inline col-2" >
                        <input class="form-check-input" type="radio" name="repartition" value="repartitionCommercial" checked>
                        <label class="form-check-label" for="inlineRadio1">Répartition commerciale</label>
                    </div>
                    <div class="form-check form-check-inline col-2" >
                        <input class="form-check-input" type="radio" name="repartition" id="DensityInstallation" value="installation" disabled>
                        <label class="form-check-label" for="inlineRadio1">Densité installation</label>
                    </div>
                    <div class="form-check form-check-inline col-2" >
                        <input class="form-check-input" type="radio" name="repartition" id="DensityInstallateur" value="installateur" disabled>
                        <label class="form-check-label" for="inlineRadio1">Densité installateur</label>
                    </div>
                    <div class="form-check form-check-inline col-2" >
                        <input class="form-check-input" type="radio" name="repartition" id="rapport" value="rapport" disabled>
                        <label class="form-check-label" for="inlineRadio1">Rapport installation-installateur</label>
                    </div>
                </div> 
            </fieldset> 
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-9" id="col-map">                       
            <div id="map" class="rounded">
                <div id="resizer"></div>
            </div>
            <div id="nuancier"></div>
            <div id="unite"></div>
        </div>
        <div class="col-3">
            <ul id="list_profil"></ul>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-12">
            <table 
                id="table"
                data-sortable="true">
            </table>
        </div>
    </div>
</div>
{{ profils|json_script:'profils' }}
{{install_total|json_script:'install_total'}}
{%endblock%}